<div *ngIf="storyGroups.length > 0" class="category-tabs">
  <button *ngFor="let group of storyGroups; let i = index"
          [class.active]="i === currentGroupIndex"
          (click)="selectGroup(i)">
    {{ group.category }}
  </button>
</div>

<div class="status-container" *ngIf="currentGroup">
  <div class="status-progress-bars">
    <div *ngFor="let s of currentGroup.storys; let i = index" class="progress-segment">
      <div class="progress-fill"
           [style.width.%]="i < currentStoryIndex ? 100 : i === currentStoryIndex ? progress : 0">
      </div>
    </div>
  </div>

  <div class="status-header">
    <img class="profile-pic" [src]="user.profilePicUrl" alt="Profile">
    <div class="user-info">
      <div class="username">{{ user.firstName }} {{ user.lastName }}</div>
      <div class="time-ago">{{ getTimeAgo(currentGroup.storys[currentStoryIndex].createdAt) }}</div>
    </div>
  </div>

  <img *ngIf="currentGroup.storys[currentStoryIndex].imageUrl"
       [src]="currentGroup.storys[currentStoryIndex].imageUrl"
       class="status-image" />
  <video *ngIf="currentGroup.storys[currentStoryIndex].videoUrl"
         [src]="currentGroup.storys[currentStoryIndex].videoUrl"
         controls class="status-video"></video>

  <div class="status-text">{{ currentGroup.storys[currentStoryIndex].content }}</div>

  <div class="like-heart" [class.animate]="showLikeAnimation">❤</div>

  <div class="status-bottom">
    <div class="status-actions">
      <button class="action-btn" (click)="toggleLike(currentGroup.storys[currentStoryIndex].id)">
        <lucide-icon name="heart"></lucide-icon>
      </button>
      <button class="action-btn" (click)="toggleCommentBox(currentGroup.storys[currentStoryIndex].id)">
        <lucide-icon name="message-circle"></lucide-icon>
      </button>
      <button class="action-btn" (click)="shareStatus(currentGroup.storys[currentStoryIndex].id)">
        <lucide-icon name="send"></lucide-icon>
      </button>
    </div>

    <div class="comment-box"
         [class.active]="commentBoxOpenFor === currentGroup.storys[currentStoryIndex].id">
      <input type="text" class="comment-input" placeholder="כתוב תגובה..." [(ngModel)]="newComment"
             (keydown.enter)="sendComment(currentGroup.storys[currentStoryIndex].id)">
      <button class="send-btn" (click)="sendComment(currentGroup.storys[currentStoryIndex].id)">שלח</button>
    </div>
  </div>

  <div class="tap-area tap-left" (click)="prevStatus()"></div>
  <div class="tap-area tap-right" (click)="nextStatus()"></div>
</div>
