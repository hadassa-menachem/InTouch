<div *ngIf="storyGroups.length > 0" class="category-tabs">
  <button *ngFor="let group of storyGroups; let i = index"
          [class.active]="i === currentGroupIndex"
          (click)="selectGroup(i)">
    {{ group.category }}
  </button>
</div>

<div *ngIf="story" class="status-container">

  <div class="status-progress-bars">
    <div *ngFor="let s of currentGroup?.stories; let i = index" class="progress-segment">
      <div class="progress-fill"
           [style.width.%]="i < currentStoryIndex ? 100 : i === currentStoryIndex ? progress : 0">
      </div>
    </div>
  </div>

  <div class="status-header">
    <img class="profile-pic" 
         [src]="story.user?.profilePicUrl" 
         alt="Profile"
         (click)="showTemporaryStories(story.user?.userId)">
    <div class="user-info">
      <div class="username">{{ story.user?.firstName }} {{ story.user?.lastName }}</div>
      <div class="time-ago">{{ getTimeAgo(story.createdAt) }}</div>
    </div>
  </div>

  <img *ngIf="story.imageUrl"
       [src]="story.imageUrl"
       class="status-image" />
  <video *ngIf="story.videoUrl"
         [src]="story.videoUrl"
         controls class="status-video"></video>

  <div class="status-text">{{ story.content }}</div>

  <div class="like-heart" [class.animate]="showLikeAnimation">❤</div>

  <div class="status-bottom">
    <div class="status-actions">
      <button class="action-btn" [class.liked]="story.likes?.includes(user.userId)"
              (click)="toggleLike(story.id)">
        <lucide-icon name="heart"></lucide-icon>
      </button>
      <button class="action-btn" (click)="toggleCommentBox(story.id)">
        <lucide-icon name="message-circle"></lucide-icon>
      </button>
      <button class="action-btn" (click)="shareStatus(story.id)">
        <lucide-icon name="send"></lucide-icon>
      </button>
    </div>

    <div class="comment-box"
         [class.active]="commentBoxOpenFor === story.id">
      <input type="text" class="comment-input" placeholder="כתוב תגובה..." [(ngModel)]="newComment"
             (keydown.enter)="sendComment(story.id)">
      <button class="send-btn" (click)="sendComment(story.id)">שלח</button>
    </div>
  </div>

  <div class="tap-area tap-left" (click)="prevStatus()"></div>
  <div class="tap-area tap-right" (click)="nextStatus()"></div>
</div>

<div *ngIf="storyGroups.length === 0" class="no-stories">
  אין סטוריז להצגה
</div>
