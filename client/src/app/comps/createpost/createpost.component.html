<div class="create-post-container">
  <form [formGroup]="createPostForm" (ngSubmit)="onSubmit()">
    
    <div class="post-preview-box">
      <div class="post-preview" [class.has-media]="imagePreviewUrl">
        
        <button 
          *ngIf="imagePreviewUrl" 
          type="button" 
          class="remove-media-btn"
          (click)="removeMedia()">
          <lucide-icon name="X" [size]="20"></lucide-icon>
        </button>

        <div class="upload-overlay-corner" *ngIf="!imagePreviewUrl">
          <input 
            type="file" 
            id="fileInput"
            (change)="onFileSelected($event)" 
            accept="image/*,video/*"
            style="display: none"/>
          <label for="fileInput" class="upload-btn-corner">
            <lucide-icon name="Plus" [size]="32"></lucide-icon>
          </label>
        </div>

        <ng-container *ngIf="imagePreviewUrl">
          <img
            *ngIf="createPostForm.value.mediaType === 'image'"
            [src]="imagePreviewUrl"
            class="preview-image"/>

          <video
            *ngIf="createPostForm.value.mediaType === 'video'"
            [src]="imagePreviewUrl"
            class="preview-video"
            autoplay
            muted
            loop>
          </video>
        </ng-container>

        <div class="no-media-message" *ngIf="!imagePreviewUrl">
          <lucide-icon name="image" [size]="64"></lucide-icon>
          <p>Upload photo or video</p>
        </div>

        <div class="icons-toolbar">
          <button type="submit" class="icon-btn" [disabled]="!imagePreviewUrl">
            <lucide-icon name="send"></lucide-icon>
            <span>Publish</span>
          </button>
        </div>
      </div>
    </div>

    <div 
      *ngIf="showMessage" 
      [ngClass]="{ 'success': isSuccess, 'error': !isSuccess }" 
      class="floating-message">
      {{ messageText }}
    </div>
  </form>
        <div class="popup-box text-popup">
          <div class="text-with-emoji-inline">
            <input
              formControlName="customText"
              #messageInputRef
              type="text"
              placeholder="Type text..." />
            <button 
              type="button" 
              class="emoji-btn-inline"
              #emojiButtonRef
              [class.active]="showEmojiPicker"
              (click)="toggleEmojiPicker($event)">
              <lucide-icon name="smile"></lucide-icon>
            </button>
          </div>
          
          <div class="emoji-dropdown" *ngIf="showEmojiPicker" #emojiPickerRef>
            <emoji-mart 
              (emojiSelect)="addEmoji($event)"
              [style]="{ width: '100%', maxWidth: '320px' }"
              [showPreview]="false">
            </emoji-mart>
          </div>
        </div>
</div>